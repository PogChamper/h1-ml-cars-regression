# Домашнее задание номер 1!

**Streamlit приложение:** https://h1-ml-cars-regression-wfwfnkdtwo4dx9s9hkkgoj.streamlit.app/

## Что было сделано

### Часть 1: EDA
- Анализ пропусков и дубликатов
- Обработка строковых столбцов
- Построение дашборда
- Визуализации: pairplot, heatmap корреляций, boxplot

### Часть 2: Модели на числовых признаках
- LinearRegression (baseline): R2 = 0.599
- Реализация R2 и Adjusted R2 вручную
- Lasso, ElasticNet с GridSearchCV
- L0 регуляризация (полный перебор подмножеств)

### Часть 3: Добавление категориальных признаков
- OneHot Encoding для brand, fuel, transmission, owner
- Ridge регрессия: R2 = 0.786

### Часть 4 (бонус): Feature Engineering
**Пункт 1 - Генерация признаков:**
- power_per_liter (мощность на литр)
- year_squared (квадрат года)
- age (возраст авто)
- km_per_year (пробег в год)
- torque_per_liter

**Пункт 2 - Еще признаков!!!**
- model (извлечение из name)
- is_third_plus_owner
- is_premium_seller
- is_low_mileage
- is_auto_diesel

**Пункт 3 - Работа с данными:**
- Log-преобразование целевой переменной
- Полиномиальные признаки

### Часть 5: Бизнес-метрики
- Доля прогнозов в пределах 10%: **47.2%**
- Асимметричная метрика (недопрогноз хуже): **0.211**

## Результаты

| Модель | Test R2 |
|--------|---------|
| LinearRegression (baseline) | 0.5990 |
| Ridge + OHE | 0.7860 |
| Ridge + FE пункт 1 | 0.7955 |
| Ridge + FE пункт 1+2 | 0.9175 |
| Ridge + log(target) | 0.9406 |
| **Ridge + полиномы + log(target)** | **0.9505** |

## Что дало наибольший прирост

1. **Добавление модели авто** (из name) - прирост ~12%
2. **Log-преобразование таргета** - прирост ~2.3%
3. **Полиномиальные признаки** - прирост ~1%

## Что не удалось

- Target Encoding показал худшие результаты, чем OHE
- Удаление выбросов ухудшило модель, причем ухудшалось при любых перцентилях удаления 

## Установка и запуск

### Создание окружения conda + установка через pip
```bash
# Создаем пустое окружение с Python 3.10
conda create -n cars_regression python=3.10 -y

# Активируем
conda activate cars_regression

# Устанавливаем зависимости через pip
pip install -r requirements-full.txt
```

### Запуск ноутбука
```bash
conda activate cars_regression
jupyter notebook AI_HW1_Regression_with_inference_pro.ipynb
```

### Запуск Streamlit
```bash
conda activate cars_regression
streamlit run app.py
```

## Streamlit приложение

Приложение содержит 3 раздела:

### EDA
- Распределение цен
- Boxplot цены по типу топлива и трансмиссии
- Scatter plot: год - цена
- Корреляционная матрица
- Описательные статистики данных

### Предсказание
- Ручной ввод: заполнение полей для одного авто, чтобы продать ее выгодно на индийском рынке B)
- CSV загрузка: batch-предсказание для нескольких авто
- Скачивание результатов

### Веса модели
- Информация о модели (R2, alpha)
- Гистограмма распределения коэффициентов
- Топ-20 признаков по влиянию на цену
- Таблица всех коэффициентов

## Оценка сервиса

**Удобство использования:**
- Есть поддержка ручного ввода и CSV, это самое прикольное, наверное, для реального сервиса

**Что получилось хорошо:**
- Думаю с необходимыми пунктами справился

**Ограничения:**
- Требуется точное соответствие формату CSV

**Планы на улучшение:**
- Валидация входных данных?
